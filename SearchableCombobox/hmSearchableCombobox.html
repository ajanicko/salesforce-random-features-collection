<template>
    <div class={classes}>
        <label for="searchableComboboxInput">{label}</label>

        <p lwc:if={helptext} class="hm-helptext">{helptext}</p>

        <div class="slds-form-element__control">
            <div class="slds-combobox_container">
                <div class={dropdownClasses} data-id="resultBox" aria-expanded="false" aria-haspopup="listbox"
                    role="combobox">

                    <img src={searchIcon} class="hm-combobox-search-icon" alt="" role="presentation">

                    <input data-id="searchableComboboxInput" type={inputType} placeholder={placeholder}
                        oninput={handleSearchKeyChange} oncommit={handleInputCommit}
                        class="slds-input hm-address-search hm-input" value={selectedValue} onfocus={handleFocus}
                        onclick={stopClickPropagation} disabled={disabled} />

                    <!-- Clear button. -->
                    <button lwc:if={showClearButton} class="hm-combobox-search-clear" type="reset" onclick={handleClear}>
                        <lightning-icon size="x-small" variant="brand" icon-name="utility:close"></lightning-icon>
                    </button>

                    <!-- Display option Results -->
                    <div lwc:if={isDropdownVisible} data-id="searchResults"
                        class="slds-dropdown slds-dropdown_length-with-icon-7 slds-dropdown_fluid"
                        role="listbox">
                        <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                            <template for:each={options} for:item="option">
                                <li role="presentation" class="slds-listbox__item" key={option.id}>
                                    <div data-id={option.id} onclick={handleSelectOption}
                                        class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta"
                                        role="option">
                                        <span
                                            class="slds-listbox__option-text slds-listbox__option-text_entity slds-p-around--xx-small">
                                            {option.text} {option.description}
                                        </span>
                                    </div>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>